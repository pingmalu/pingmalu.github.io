---
layout: post
title:  "Termux使用笔记"
---

记录Termux日常使用记录


官网：[https://termux.com/](https://termux.com/)

国内用户去这里下载：[https://f-droid.org/packages/com.termux/](https://f-droid.org/packages/com.termux/)

termux清华大学开源软件镜像站[https://mirrors.tuna.tsinghua.edu.cn/help/termux/](https://mirrors.tuna.tsinghua.edu.cn/help/termux/)

### 内部存储和外部存储（sd卡）访问

参考官方文档：[https://termux.com/storage.html](https://termux.com/storage.html)

先把**termux-setup-storage**安装好

再往$HOME目录建立storage文件夹

	mkdir storage 

然后执行（需要在手机终端下执行，远程ssh执行无效）

	termux-setup-storage

比如建好后：

	bash-4.4$ ls ~/storage/
	dcim        downloads   external-1  movies      music       pictures    shared

external-1即是外部sd卡目录


### 调用摄像头等设备

参考文档:[https://wiki.termux.com/wiki/Termux:API](https://wiki.termux.com/wiki/Termux:API)

先去安装：termux.api   [https://f-droid.org/packages/com.termux.api/](https://f-droid.org/packages/com.termux.api/)

然后执行：

	 pkg install termux-api

拍照:

	termux-camera-photo 1.jpg

### 开机启动

参考文档：[https://wiki.termux.com/wiki/Termux:Boot](https://wiki.termux.com/wiki/Termux:Boot)

先安装：termux.boot [https://f-droid.org/packages/com.termux.boot/](https://f-droid.org/packages/com.termux.boot/)

执行一下termux.boot让它能开机启动，然后建立目录 ~/.termux/boot/

比如要启动sshd和python脚本, 在该目录下建立启动文件~/.termux/boot/start-boot：

	termux-wake-lock
	sshd
	python2 xxx.py


### Python环境相关

默认安装pip3，在pip list会出现警告，需要在$HOME目录建立文件
	
	bash-4.4$ cat ~/.pip/pip.conf 
	[global]
	format=legacy

有些库会依赖clang编译，需要把clang安装上

	apt install clang


### PyInstaller安装问题

PyInstaller在arm平台下打包编译会有问题，原因是默认会加载Linux-64bit引导程序

我们只需在arm下重新编译bootloader，然后替换掉Linux-64bit里的run文件：

PyInstaller源码下载：[https://github.com/pyinstaller/pyinstaller/releases](https://github.com/pyinstaller/pyinstaller/releases)

操作过程：

1.解压源码

2.进入目录 PyInstaller-3.3/bootloader

3.执行（注意python版本，如果是python3那用 python3 ./waf distclean all）

	python2 ./waf distclean all

正常情况下编译结束会在build/release/ 目录下有个run文件

	bash-4.4$ file build/release/run 
	build/release/run: ELF 64-bit LSB shared object, ARM aarch64, version 1 (SYSV), dynamically linked, interpreter /system/bin/linker64, stripped

如果报错：

> ../../src/pyi_launch.c:32:14: fatal error: 'langinfo.h' file not found

那先把对应行号注释调吧，目前用下来暂时没啥影响。(貌似是python2下才会出现)

4.然后把PyInstaller-3.3/PyInstaller/bootloader/Linux-64bit-aarch/ 目录下的文件copy至/data/data/com.termux/files/usr/lib/python2.7/site-packages/PyInstaller/bootloader/Linux-64bit/


注：PyInstaller-3.3.1 修复了引导问题，但是langinfo.h的问题还是可以通过上述办法解决。




