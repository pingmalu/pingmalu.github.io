---
layout: post
title: 高可用网站架构演讲
---

# 什么是高可用

是指以减少服务中断时间为目的技术统称。它通过保护用户的业务程序对外不间断地提供服务，把因为软件，硬件，人为造成的故障对业务的影响降低到最小程度。总而言之就是保证公司业务7*24小时不宕机。

## 高可用的衡量标准

通常用平均无故障时间(MTTF：mean time to failure)来衡量系统的可靠性，用平均故障维修时间（MTTR：Mean Time Between Failures）来度量系统的可维护性。于是可用性被定义为： HA=MTTF/(MTTF+MTTR)*100%。

简单理解：如果系统每运行100个时间单位，会有1个时间单位无法提供服务，我们说系统的可用性是99%。

**衡量也受监测设备的局限，比如监测设备本身的故障、监测点的盲区、监测链路的网络故障等影响，不存在完美的衡量标准！**

# 如何保障系统的高可用

我们都知道，单点往往是系统高可用最大的风险和敌人，应该尽量在系统设计的过程中避免单点。方法论上，高可用保证的原则是“集群化”，或者叫“冗余”：只有一个单点，挂了服务会受影响；如果有冗余备份，挂了还有其他backup能够顶上。

保证系统高可用，架构设计的核心准则是：冗余。

有了冗余之后，还不够，如果每次出现故障需要人工介入恢复势必会增加系统的不可服务时间。所以，又往往是通过“自动故障转移”来实现系统的高可用。

# 下面我们看看一般网站架构是如何做冗余的

[第四页架构图]

**图上是一个比较大型的网站架构图，可以看到里面大量使用到了分布式集群化部署，但是在网站初期考虑到成本、人员、项目进度等因素，一般会采用单点形式，不要觉得单点很low，事实上大部分公司目前还是采用单点形式，分布式集群并不适合所有场景。**

**下面来想想看为什么？** （为什么分布式集群并不适合所有场景？）

先来通俗解释一下什么是分布式：原本需要一个人干的事，现在分给n个人干！

但问题来了，既然分给了n个人，那就涉及到这些人的沟通交流协作问题。

要去解决这些问题，就需要先聊聊分布式系统中的CAP理论。

# CAP定理

[第五页CAP理论]

我们先来了解一下这个理论产生的历史，CAP定理，也叫布鲁尔定理。

这个定理起源于加州大学柏克莱分校的计算机科学家埃里克·布鲁尔在2000年的分布式计算原理研讨会上提出的一个猜想。 在2002年，MIT也就是麻省理工学院的赛斯·吉尔伯特 和 南希·林奇 发表了 **布鲁尔猜想** 的证明，使之成为一个定理。

事实上 吉尔伯特 和 林奇 证明的CAP定理比 布鲁尔 设想的某种程度上更加狭义。定理讨论了在两个互相矛盾的请求到达彼此连接不通的两个不同的分布式节点的时候的处理方案。

## 下面我们来探讨一下CAP定理

CAP理论指的是一个分布式系统最多只能同时满足一致性（Consistency）、可用性（Availability）和分区容错性（Partition tolerance）这三项中的两项。











